(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     90622,       2579]
NotebookOptionsPosition[     82493,       2433]
NotebookOutlinePosition[     82896,       2449]
CellTagsIndexPosition[     82853,       2446]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Sh", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a_", ",", " ", "b___"}], "]"}], ",", " ", 
     RowBox[{"S", "[", 
      RowBox[{"c_", ",", " ", "d___"}], "]"}]}], "]"}], ":=", 
   RowBox[{"SPlus", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a", ",", " ", 
       RowBox[{"Sh", "[", 
        RowBox[{
         RowBox[{"S", "[", "b", "]"}], ",", " ", 
         RowBox[{"S", "[", 
          RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"c", ",", 
       RowBox[{"Sh", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"a", ",", "b"}], "]"}], ",", 
         RowBox[{"S", "[", "d", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh", "[", 
    RowBox[{
     RowBox[{"S", "[", "]"}], ",", "a_"}], "]"}], ":=", "a"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh", "[", 
    RowBox[{"a_", ",", 
     RowBox[{"S", "[", "]"}]}], "]"}], ":=", "a"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh", "[", 
    RowBox[{"a_", ",", "b_", ",", "c__"}], "]"}], ":=", 
   RowBox[{"Sh", "[", 
    RowBox[{
     RowBox[{"Sh", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh", "[", 
    RowBox[{"a_SPlus", ",", " ", "y___"}], "]"}], ":=", 
   RowBox[{"SPlus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Sh", "[", 
        RowBox[{"#", ",", " ", "y"}], "]"}], "&"}], " ", "/@", " ", "a"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh", "[", 
    RowBox[{"y___", ",", " ", "a_SPlus"}], "]"}], ":=", 
   RowBox[{"SPlus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Sh", "[", 
        RowBox[{"y", ",", " ", "#"}], "]"}], "&"}], " ", "/@", " ", "a"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sh", "[", 
   RowBox[{"x___", ",", " ", 
    RowBox[{"SScalar", "[", 
     RowBox[{"a_", ",", " ", "b__"}], "]"}], ",", " ", "y___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"SScalar", "[", 
    RowBox[{"a", ",", " ", 
     RowBox[{"Sh", "[", 
      RowBox[{"x", ",", " ", "b", ",", " ", "y"}], "]"}]}], "]"}], " ", "/;", 
   " ", 
   RowBox[{"NumericQ", "[", "a", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules1", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"x___", ",", " ", "a_SPlus", ",", " ", "y___"}], "]"}], ":>", 
      RowBox[{"SPlus", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"x", ",", "#", ",", "y"}], "]"}], "&"}], " ", "/@", " ", 
         "a"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"SScalar", "[", 
          RowBox[{"b_", " ", ",", "a__S"}], "]"}], ",", "y___"}], "]"}], "/;", 
       RowBox[{"NumericQ", "[", "b", "]"}]}], ":>", 
      RowBox[{"SScalar", "[", 
       RowBox[{"b", ",", " ", 
        RowBox[{"S", "[", 
         RowBox[{"x", ",", "a", ",", "y"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"___", ",", 
        RowBox[{"-", "1"}], ",", "___"}], "]"}], ":>", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"___", ",", "1", ",", "___"}], "]"}], ":>", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"___", ",", "0", ",", "___"}], "]"}], ":>", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"a___", ",", 
        RowBox[{"S", "[", "b__", "]"}], ",", " ", "c___"}], "]"}], ":>", 
      RowBox[{"S", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"SPlus", "[", "a_S", "]"}], ":>", "a"}], ",", " ", 
     RowBox[{
      RowBox[{"SPlus", "[", 
       RowBox[{"x___", ",", " ", "a__SPlus", ",", " ", "y___"}], "]"}], ":>", 
      RowBox[{"SPlus", "[", 
       RowBox[{"x", ",", " ", "a", ",", " ", "y"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules3", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"x___", ",", "a_Plus", ",", "y___"}], "]"}], ":>", 
      RowBox[{"Plus", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"x", ",", " ", "#", ",", " ", "y"}], "]"}], "&"}], " ", "/@",
          " ", "a"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"b_", " ", "a_S"}], " ", ",", "y___"}], "]"}], "/;", 
       RowBox[{"NumericQ", "[", "b", "]"}]}], ":>", 
      RowBox[{"b", " ", 
       RowBox[{"S", "[", 
        RowBox[{"x", ",", "a", ",", "y"}], "]"}]}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.8897077472594295`*^9, {3.8897077946252728`*^9, 3.88970796214688*^9}, {
   3.8897079966419773`*^9, 3.8897080363435583`*^9}, {3.8897080702871327`*^9, 
   3.8897080780311966`*^9}, {3.889708183595028*^9, 3.8897081913633394`*^9}, 
   3.889708285567093*^9},
 CellLabel->
  "In[306]:=",ExpressionUUID->"495c9de9-3f8a-40a9-bb7a-69b40be41516"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sh", "[", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{
         RowBox[{"1", "+", "x"}], ",", 
         RowBox[{"1", "-", 
          RowBox[{"1", "/", "x"}]}]}], "]"}], ",", " ", 
       RowBox[{"SPlus", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"c", ",", "d"}], "]"}], ",", " ", 
         RowBox[{"SScalar", "[", 
          RowBox[{"2", ",", 
           RowBox[{"SPlus", "[", 
            RowBox[{
             RowBox[{"S", "[", 
              RowBox[{"a1", ",", " ", "3"}], "]"}], ",", " ", 
             RowBox[{"S", "[", 
              RowBox[{"a2", ",", "4"}], "]"}]}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"S", "[", "e", "]"}]}], "]"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Plus", "->", "P"}], ",", " ", 
       RowBox[{"Times", "->", "T"}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SPlus", "->", "Plus"}], ",", " ", 
      RowBox[{"SScalar", "->", "Times"}]}], "}"}]}], "//.", " ", 
   RowBox[{"Union", "[", 
    RowBox[{"rules2", ",", "rules3"}], "]"}]}], "//.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"P", "->", "Plus"}], ",", " ", 
    RowBox[{"T", "->", "Times"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8897074672088556`*^9, 3.889707557652545*^9}, {
  3.8897082319615955`*^9, 3.8897082414720583`*^9}, {3.889708379497818*^9, 
  3.8897083801864653`*^9}, {3.8897084584311495`*^9, 3.889708510252398*^9}, {
  3.8897085461082907`*^9, 3.8897085805221996`*^9}, {3.889709622449601*^9, 
  3.889709627488285*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"d76ef1d8-e31d-4c67-add3-182b3836b588"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"e", ",", 
    RowBox[{"1", "+", "x"}], ",", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"]}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"1", "+", "x"}], ",", "e", ",", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"]}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"1", "+", "x"}], ",", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"]}], ",", "e"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"c", ",", "d", ",", 
    RowBox[{"1", "+", "x"}], ",", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"]}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"c", ",", 
    RowBox[{"1", "+", "x"}], ",", "d", ",", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"]}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"c", ",", 
    RowBox[{"1", "+", "x"}], ",", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"]}], ",", "d"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"1", "+", "x"}], ",", "c", ",", "d", ",", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"]}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"1", "+", "x"}], ",", "c", ",", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"]}], ",", "d"}], "]"}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a1", ",", "3", ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}]}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{"a1", ",", 
       RowBox[{"1", "+", "x"}], ",", "3", ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}]}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{"a1", ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}], ",", "3"}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{"a2", ",", "4", ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}]}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{"a2", ",", 
       RowBox[{"1", "+", "x"}], ",", "4", ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}]}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{"a2", ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}], ",", "4"}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", "a1", ",", "3", ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}]}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", "a1", ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}], ",", "3"}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", "a2", ",", "4", ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}]}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", "a2", ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}], ",", "4"}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}], ",", "a1", ",", "3"}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}], ",", "a2", ",", "4"}], "]"}]}], ")"}]}], "+", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"1", "+", "x"}], ",", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"]}], ",", "c", ",", "d"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.889708206330507*^9, {3.8897082421361065`*^9, 3.8897082494628396`*^9}, 
   3.8897082889852962`*^9, {3.889708380664502*^9, 3.889708385598418*^9}, {
   3.8897084697349524`*^9, 3.889708510651271*^9}, {3.8897085557252183`*^9, 
   3.889708580925455*^9}, {3.8897096231722307`*^9, 3.889709628289113*^9}},
 CellLabel->"Out[62]=",ExpressionUUID->"170f5bf3-ccc5-492f-b33a-082a75843d55"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8897082460696454`*^9, 
  3.889708247070822*^9}},ExpressionUUID->"51d9087d-8335-474e-9d85-\
665bbf1b6f9b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"1", "+", "x"}], ",", 
    RowBox[{"SPlus", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"1", "-", 
         FractionBox["1", "x"]}], ",", 
        RowBox[{"S", "[", 
         RowBox[{"c", ",", "d"}], "]"}]}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"c", ",", 
        RowBox[{"SPlus", "[", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{
            RowBox[{"1", "-", 
             FractionBox["1", "x"]}], ",", 
            RowBox[{"S", "[", "d", "]"}]}], "]"}], ",", 
          RowBox[{"S", "[", 
           RowBox[{"d", ",", 
            RowBox[{"S", "[", 
             RowBox[{"1", "-", 
              FractionBox["1", "x"]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], "]"}], "//.", "rules1"}]], "Input",
 CellChangeTimes->{{3.8897084051206303`*^9, 3.8897084083205214`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"26705059-01f2-4dea-8018-be64daf1156f"],

Cell[BoxData[
 RowBox[{"SPlus", "[", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"1", "+", "x"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"1", "-", 
        FractionBox["1", "x"]}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"SPlus", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"c", ",", 
         RowBox[{"S", "[", 
          RowBox[{
           RowBox[{"1", "-", 
            FractionBox["1", "x"]}], ",", 
           RowBox[{"S", "[", "d", "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"c", ",", 
         RowBox[{"S", "[", 
          RowBox[{"d", ",", 
           RowBox[{"S", "[", 
            RowBox[{"1", "-", 
             FractionBox["1", "x"]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.88970840880048*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"bdd83ca5-5dd7-4b8a-b1fb-ef9faf8af990"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sh", "[", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"1", "/", "x"}]}], ",", " ", "b"}], "]"}], ",", " ", 
       RowBox[{"S", "[", 
        RowBox[{"c", ",", "d"}], "]"}]}], "]"}], "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Plus", "->", "P"}], ",", " ", 
       RowBox[{"Times", "->", "T"}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SPlus", "->", "Plus"}], ",", " ", 
      RowBox[{"SScalar", "->", "Times"}]}], "}"}]}], " ", "//.", " ", 
   RowBox[{"Union", "[", 
    RowBox[{"rules2", ",", " ", "rules3"}], "]"}]}], " ", "//.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"P", "->", "Plus"}], ",", " ", 
    RowBox[{"T", "->", "Times"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8897103333330607`*^9, 3.8897103493148527`*^9}, {
  3.8897104099762783`*^9, 3.889710445791649*^9}},
 CellLabel->
  "In[319]:=",ExpressionUUID->"5baa08bc-debe-48a2-a678-8dfabf4e861a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"c", ",", "d", ",", 
    RowBox[{"1", "+", 
     FractionBox["1", "x"]}], ",", "b"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"c", ",", 
    RowBox[{"1", "+", 
     FractionBox["1", "x"]}], ",", "b", ",", "d"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"c", ",", 
    RowBox[{"1", "+", 
     FractionBox["1", "x"]}], ",", "d", ",", "b"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"1", "+", 
     FractionBox["1", "x"]}], ",", "b", ",", "c", ",", "d"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"1", "+", 
     FractionBox["1", "x"]}], ",", "c", ",", "b", ",", "d"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"1", "+", 
     FractionBox["1", "x"]}], ",", "c", ",", "d", ",", "b"}], 
   "]"}]}]], "Output",
 CellChangeTimes->{{3.88971035118548*^9, 3.889710363698762*^9}, 
   3.889710412881792*^9, 3.889710446313379*^9},
 CellLabel->
  "Out[319]=",ExpressionUUID->"23ad1d1d-41f8-460a-92de-d54d9136e60b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Symbols`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.889716869046836*^9, 3.889716875236579*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ec3bc6d0-91a3-4447-87a4-19d023dab68d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s1", " ", "=", " ", 
  RowBox[{"SymbG", "[", 
   RowBox[{"G", "[", 
    RowBox[{"1", ",", "1", ",", "x"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8897168779980016`*^9, 3.889716892180139*^9}, {
  3.8897169829686613`*^9, 3.889716983944875*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"14ee395e-5273-41d7-b00f-499adffff654"],

Cell[BoxData[
 RowBox[{"SymbScalar", "[", 
  RowBox[{"1", ",", 
   RowBox[{"Symb", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8897168925609355`*^9, 3.889716985183675*^9, {3.889721275753092*^9, 
   3.8897212976746216`*^9}, {3.8897213322013884`*^9, 3.889721344641986*^9}, {
   3.890040632898267*^9, 3.8900406404225864`*^9}, {3.890104163462737*^9, 
   3.8901041736907225`*^9}, 3.890104599262143*^9, {3.8901119033694186`*^9, 
   3.890111912384174*^9}, 3.8901121891965733`*^9, 3.8901302751400814`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"c0c3a201-6b9a-4643-b5ef-55291525f56c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s2", " ", "=", " ", 
  RowBox[{"SymbG", "[", 
   RowBox[{"G", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "x"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8897168992296257`*^9, 3.889716905443365*^9}, {
  3.889716987984113*^9, 3.8897169885120277`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"41ed0650-d732-4eb3-85a0-f229e9e09718"],

Cell[BoxData[
 RowBox[{"SymbScalar", "[", 
  RowBox[{"1", ",", 
   RowBox[{"Symb", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ",", "x", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8897169058288097`*^9, 3.8897169887919416`*^9, {3.889721285625578*^9, 
   3.8897212952178087`*^9}, {3.8897213346730585`*^9, 3.8897213492398014`*^9}, 
   3.890040658176156*^9, 3.8901041761711698`*^9, 3.890111914639344*^9, 
   3.8901121916739764`*^9, 3.8901302776370687`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"7ed9144c-7147-42d3-9d09-32ce9231df2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res", " ", "=", " ", 
  RowBox[{"Shuffle", "[", 
   RowBox[{"{", 
    RowBox[{"s1", ",", " ", "s2"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.889716925635671*^9, 3.8897170237665358`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"37eb9f49-b213-4f08-ae42-6a6098f66c2a"],

Cell[BoxData[
 RowBox[{"SymbPlus", "[", 
  RowBox[{
   RowBox[{"SymbScalar", "[", 
    RowBox[{"3", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", "x", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{"4", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", "x", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{"3", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", "x", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}]}], "]"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.8897169486067486`*^9, 3.8897169622052417`*^9}, 
   3.8897169942110186`*^9, 3.8897170243426523`*^9, {3.8897213573444667`*^9, 
   3.8897213602164297`*^9}, 3.8897215621546965`*^9, 3.8900406611554413`*^9, 
   3.890104178510923*^9, 3.890104604458025*^9, 3.8901048940467043`*^9, 
   3.890104941503423*^9, 3.8901119165961056`*^9, 3.8901119489470816`*^9, 
   3.890112194842541*^9, 3.890130281139943*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"b2b38825-bed9-41f7-b930-bc572dbf858f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymbolicExpressionToReadable", "[", "res", "]"}]], "Input",
 CellChangeTimes->{{3.889717026799656*^9, 3.8897170348297243`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"ff6a98d5-9793-4489-9814-5e6c6d6af2ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "\[CircleTimes]", "x", 
    "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}]}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "\[CircleTimes]", "x", 
    "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}]}]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "\[CircleTimes]", "x", 
    "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "\[CircleTimes]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.889717035264864*^9, 3.890040663903603*^9, 
  3.8901041810636396`*^9, 3.8901302856117516`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"25ed3cd6-43d1-4ca5-b398-2e76d12fbc2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Shuffle", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Symb", "[", 
       RowBox[{"a", ",", " ", "b", ",", "x"}], "]"}], ",", " ", 
      RowBox[{"Symb", "[", 
       RowBox[{"c", ",", " ", "d", ",", " ", "y"}], "]"}], ",", " ", 
      RowBox[{"Symb", "[", 
       RowBox[{"e", ",", " ", "f", ",", " ", "z"}], "]"}], ",", " ", 
      RowBox[{"Symb", "[", "j", "]"}], ",", " ", 
      RowBox[{"Symb", "[", "k", "]"}]}], "}"}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.889721375463155*^9, 3.8897213803504906`*^9}, {
   3.889721445028361*^9, 3.889721550656003*^9}, 3.890040675567998*^9, {
   3.8901304967403603`*^9, 3.8901305004547544`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"3c267831-0c62-49cf-833a-28fe95913abf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.7683497`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.889721551276869*^9, {3.890040666022683*^9, 3.890040676087036*^9}, 
   3.890104183382349*^9, 3.8901046523225737`*^9, 3.8901048993716917`*^9, 
   3.890104938731896*^9, 3.890130297693858*^9, {3.8901305039479136`*^9, 
   3.8901305125805435`*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"9970c952-9130-4f17-8461-46241c47cd73"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test1", " ", "=", " ", 
  RowBox[{"Shuffle", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{"x", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}], ",", " ", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"x", "+", "1"}], ")"}]}]}], "]"}], ",", " ", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"x", "+", "1"}], ")"}]}]}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8901046703824325`*^9, 3.890104678284586*^9}, {
  3.890104728956155*^9, 3.890104732459303*^9}, {3.890130567594845*^9, 
  3.8901306050322533`*^9}, {3.890130696773964*^9, 3.8901307192213335`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"b2e7e041-2e33-4df1-92df-2636527a63cc"],

Cell[BoxData[
 RowBox[{"SymbPlus", "[", 
  RowBox[{
   RowBox[{"Symb", "[", 
    RowBox[{
     RowBox[{"1", "+", "x"}], ",", 
     FractionBox["1", 
      RowBox[{"1", "+", "x"}]], ",", 
     RowBox[{"x", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}]}], ",", 
     FractionBox["1", 
      RowBox[{"1", "+", "x"}]]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}], ",", 
       FractionBox["1", 
        RowBox[{"1", "+", "x"}]], ",", 
       FractionBox["1", 
        RowBox[{"1", "+", "x"}]]}], "]"}]}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{
     RowBox[{"x", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}]}], ",", 
     FractionBox["1", 
      RowBox[{"1", "+", "x"}]], ",", 
     RowBox[{"1", "+", "x"}], ",", 
     FractionBox["1", 
      RowBox[{"1", "+", "x"}]]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}], ",", 
       RowBox[{"1", "+", "x"}], ",", 
       FractionBox["1", 
        RowBox[{"1", "+", "x"}]], ",", 
       FractionBox["1", 
        RowBox[{"1", "+", "x"}]]}], "]"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8901046790967336`*^9, 3.8901047329668097`*^9, 3.890104902969761*^9, 
   3.8901049354896593`*^9, 3.890130557359529*^9, {3.890130590807488*^9, 
   3.8901306053972607`*^9}, {3.8901306973889885`*^9, 3.8901307196330686`*^9}},
 CellLabel->"Out[21]=",ExpressionUUID->"aa2b990c-9985-429a-96da-c06e0dbeba10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymbolExpand", "[", "test1", "]"}]], "Input",
 CellChangeTimes->{{3.890130609162571*^9, 3.890130621896201*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"42933979-d8d8-45c5-abe7-15d019a876f4"],

Cell[BoxData[
 RowBox[{"SymbPlus", "[", 
  RowBox[{
   RowBox[{"SymbScalar", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}], ",", "x", ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{"x", ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", "x", ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{"x", ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}], ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8901306223486776`*^9, {3.89013069981874*^9, 3.890130726344202*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"5167145d-2f17-479b-ac6f-856093eb7f01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymbolicExpressionToList", "[", "res", "]"}]], "Input",
 CellChangeTimes->{{3.889721586271875*^9, 3.889721595014589*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"44187f68-ce01-441d-8f68-d20aad899cc0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", "x", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", "x", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", "x", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.889721596927514*^9, 3.890040682873371*^9, 
  3.8901041874438*^9, 3.8901303130116377`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"870b917d-2830-4d0f-91c2-4c4f30d0cf3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymbG", "[", 
  RowBox[{"G", "[", 
   RowBox[{"1", ",", " ", "1", ",", " ", "x"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8897216067916574`*^9, 3.88972161123095*^9}, 
   3.8897582920518284`*^9, {3.890130870776453*^9, 3.8901308803762817`*^9}, {
   3.8901309243829727`*^9, 3.890130925055344*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"eba61ab5-9cfc-41fd-a26d-1c1caa7e37d9"],

Cell[BoxData[
 RowBox[{"SymbScalar", "[", 
  RowBox[{"1", ",", 
   RowBox[{"Symb", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.8901308808442297`*^9, 3.890130925834465*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"1f2ca13d-be59-477c-94fd-7d420a431908"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rules0", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"ProjTest", "[", 
       RowBox[{"a___S", ",", "b__SPlus", ",", "c___S"}], "]"}], ":>", 
      RowBox[{"SPlus", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"x", ",", 
             RowBox[{"ProjTest", "[", 
              RowBox[{"a", ",", "x", ",", "c"}], "]"}]}], "]"}], "[", "#", 
           "]"}], "&"}], "/@", "b"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"ProjTest", "[", 
       RowBox[{"a___S", ",", " ", 
        RowBox[{"SScalar", "[", 
         RowBox[{"n_", ",", " ", "b_S"}], "]"}], ",", " ", "c___S"}], "]"}], ":>", 
      RowBox[{"SScalar", "[", 
       RowBox[{"n", ",", " ", 
        RowBox[{"ProjTest", "[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"ProjTest", "[", 
       RowBox[{"S", "[", 
        RowBox[{"a1_", ",", " ", "as___", ",", " ", "an_"}], "]"}], "]"}], ":>",
       " ", 
      RowBox[{"SPlus", "[", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{
          RowBox[{"ProjTest", "[", 
           RowBox[{"S", "[", 
            RowBox[{"a1", ",", " ", "as"}], "]"}], "]"}], ",", " ", "an"}], 
         "]"}], " ", ",", " ", 
        RowBox[{"SScalar", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", " ", 
          RowBox[{"S", "[", 
           RowBox[{
            RowBox[{"ProjTest", "[", 
             RowBox[{"S", "[", 
              RowBox[{"as", ",", " ", "an"}], "]"}], "]"}], ",", " ", "a1"}], 
           "]"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ProjTest", "[", 
       RowBox[{"S", "[", "a_", "]"}], "]"}], ":>", "a"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"x___", ",", " ", "a_SPlus", ",", " ", "y___"}], "]"}], ":>", 
      RowBox[{"SPlus", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"x", ",", "#", ",", "y"}], "]"}], "&"}], " ", "/@", " ", 
         "a"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"SScalar", "[", 
          RowBox[{"b_", " ", ",", "a__S"}], "]"}], ",", "y___"}], "]"}], "/;", 
       RowBox[{"NumericQ", "[", "b", "]"}]}], ":>", 
      RowBox[{"SScalar", "[", 
       RowBox[{"b", ",", " ", 
        RowBox[{"S", "[", 
         RowBox[{"x", ",", "a", ",", "y"}], "]"}]}], "]"}]}], ",", "\n", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"___", ",", 
        RowBox[{"-", "1"}], ",", "___"}], "]"}], ":>", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"___", ",", "1", ",", "___"}], "]"}], ":>", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"___", ",", "0", ",", "___"}], "]"}], ":>", "0"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"rules3", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"a___", ",", 
        RowBox[{"S", "[", "b__", "]"}], ",", " ", "c___"}], "]"}], ":>", 
      RowBox[{"S", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"SPlus", "[", "a_S", "]"}], ":>", "a"}], ",", " ", 
     RowBox[{
      RowBox[{"SPlus", "[", 
       RowBox[{"x___", ",", " ", "a__SPlus", ",", " ", "y___"}], "]"}], ":>", 
      RowBox[{"SPlus", "[", 
       RowBox[{"x", ",", " ", "a", ",", " ", "y"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules4", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"x___", ",", "a_Plus", ",", "y___"}], "]"}], ":>", 
      RowBox[{"Plus", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"x", ",", " ", "#", ",", " ", "y"}], "]"}], "&"}], " ", "/@",
          " ", "a"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"b_", " ", "a_S"}], " ", ",", "y___"}], "]"}], "/;", 
       RowBox[{"NumericQ", "[", "b", "]"}]}], ":>", 
      RowBox[{"b", " ", 
       RowBox[{"S", "[", 
        RowBox[{"x", ",", "a", ",", "y"}], "]"}]}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8900407589571247`*^9, 3.89004092372684*^9}, {
   3.8900410761619315`*^9, 3.8900411359112844`*^9}, {3.8900411838145742`*^9, 
   3.890041184701562*^9}, {3.890041248988041*^9, 3.8900412567559595`*^9}, 
   3.890041319721757*^9, {3.890041449437956*^9, 3.8900414535736904`*^9}, {
   3.8900419981472597`*^9, 3.8900420267712684`*^9}, {3.890042081433277*^9, 
   3.8900420819368086`*^9}, {3.8900421199442306`*^9, 3.890042162414406*^9}, {
   3.89004223090057*^9, 3.890042233652427*^9}, {3.8900422649707866`*^9, 
   3.890042369534972*^9}, {3.890042425854315*^9, 3.8900424279104176`*^9}, {
   3.8900425135148745`*^9, 3.8900425178753204`*^9}, {3.890042646327919*^9, 
   3.8900427641081605`*^9}, {3.8900428642012634`*^9, 
   3.8900428704962835`*^9}, {3.8900430594451456`*^9, 
   3.8900432056524005`*^9}, {3.890043235796481*^9, 3.8900433357123375`*^9}, {
   3.890043515627011*^9, 3.8900435167033553`*^9}, {3.8900436088883815`*^9, 
   3.8900436759575076`*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"7a1c222e-8c39-40cb-8991-09bef0765c6f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjTest", "[", 
     RowBox[{"S", "[", 
      RowBox[{"a1", ",", "a2", ",", " ", "a3"}], "]"}], "]"}], "//.", 
    "rules1"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"SPlus", "->", "Plus"}], ",", " ", 
     RowBox[{"SScalar", "->", "Times"}]}], "}"}]}], "//.", 
  RowBox[{"Union", "[", 
   RowBox[{"rules3", ",", " ", "rules4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.890041187135045*^9, 3.890041218805149*^9}, {
   3.8900412686114893`*^9, 3.89004126909157*^9}, {3.8900413315295386`*^9, 
   3.890041332025338*^9}, {3.890041365847993*^9, 3.8900413850149097`*^9}, {
   3.890041653598853*^9, 3.8900416548302794`*^9}, {3.89004180989741*^9, 
   3.8900418238565664`*^9}, {3.8900419290457354`*^9, 3.890041944260888*^9}, {
   3.890042010803234*^9, 3.890042011186828*^9}, {3.890042049265996*^9, 
   3.8900420896168804`*^9}, {3.8900421430624547`*^9, 3.890042144765607*^9}, 
   3.8900422001327915`*^9, {3.890042252691406*^9, 3.8900422660343637`*^9}, {
   3.8900423773427134`*^9, 3.890042468915506*^9}, {3.890042533986401*^9, 
   3.890042625904002*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"df59f55e-fba6-4870-a0fd-e4eb0716fdcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"a1", ",", "a2", ",", "a3"}], "]"}], "-", 
  RowBox[{"S", "[", 
   RowBox[{"a2", ",", "a1", ",", "a3"}], "]"}], "-", 
  RowBox[{"S", "[", 
   RowBox[{"a2", ",", "a3", ",", "a1"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a3", ",", "a2", ",", "a1"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.8900411972947426`*^9, 3.8900412695881505`*^9}, {
   3.8900413226399198`*^9, 3.890041332378002*^9}, {3.8900413661369267`*^9, 
   3.8900413859365396`*^9}, 3.89004161190224*^9, 3.8900416553137875`*^9, 
   3.8900418245472984`*^9, {3.890041930499189*^9, 3.890041944693392*^9}, {
   3.890042007436783*^9, 3.890042028829179*^9}, {3.890042063478325*^9, 
   3.890042089825656*^9}, {3.890042145263732*^9, 3.8900422003267913`*^9}, {
   3.890042236388382*^9, 3.890042270238256*^9}, {3.8900423858957386`*^9, 
   3.890042469407522*^9}, {3.89004253726873*^9, 3.8900426263713636`*^9}, {
   3.8900427765637712`*^9, 3.8900427806910915`*^9}, 3.8900429588257904`*^9},
 CellLabel->
  "Out[194]=",ExpressionUUID->"09cf049b-66ef-42b2-9d55-4ac72d97eea7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ProjTest", "[", 
      RowBox[{"SPlus", "[", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"a1", ",", " ", "a2", ",", " ", "a3"}], "]"}], ",", " ", 
        RowBox[{"SScalar", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"S", "[", 
           RowBox[{"b1", ",", " ", "b2", ",", " ", "b3"}], "]"}]}], "]"}], 
        ",", " ", 
        RowBox[{"S", "[", 
         RowBox[{"c1", ",", " ", "c2"}], "]"}]}], "]"}], "]"}], "//.", 
     "rules0"}], "//.", "rules1"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"SPlus", "->", "Plus"}], ",", " ", 
     RowBox[{"SScalar", "->", "Times"}]}], "}"}]}], "//.", 
  RowBox[{"Union", "[", 
   RowBox[{"rules3", ",", " ", "rules4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8900427873871536`*^9, 3.8900428412626605`*^9}, {
  3.8900430871355767`*^9, 3.8900430874306602`*^9}, {3.890043580750865*^9, 
  3.8900435843266964`*^9}, {3.8900436827634864`*^9, 3.8900436901956015`*^9}, {
  3.890043730546085*^9, 3.8900437745689993`*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"27e652b9-7344-4591-9561-4d43b3628475"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"c1", ",", "c2"}], "]"}], "-", 
  RowBox[{"S", "[", 
   RowBox[{"c2", ",", "c1"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a1", ",", "a2", ",", "a3"}], "]"}], "-", 
  RowBox[{"S", "[", 
   RowBox[{"a2", ",", "a1", ",", "a3"}], "]"}], "-", 
  RowBox[{"S", "[", 
   RowBox[{"a2", ",", "a3", ",", "a1"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a3", ",", "a2", ",", "a1"}], "]"}], "-", 
  RowBox[{"S", "[", 
   RowBox[{"b1", ",", "b2", ",", "b3"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"b2", ",", "b1", ",", "b3"}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"b2", ",", "b3", ",", "b1"}], "]"}], "-", 
  RowBox[{"S", "[", 
   RowBox[{"b3", ",", "b2", ",", "b1"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.890042842170919*^9, 3.890042875375732*^9, {3.890043088157976*^9, 
   3.890043175809333*^9}, {3.8900432510013175`*^9, 3.890043339877864*^9}, 
   3.8900435207219405`*^9, 3.8900435848637657`*^9, {3.8900436909886227`*^9, 
   3.8900436978435087`*^9}, {3.890043734923172*^9, 3.8900437794199877`*^9}},
 CellLabel->
  "Out[324]=",ExpressionUUID->"e565cdf4-d8d4-4faa-b314-4840e28d4f46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s3", " ", "=", " ", 
  RowBox[{"Proj", "[", 
   RowBox[{"SymbPlus", "[", 
    RowBox[{
     RowBox[{"Symb", "[", 
      RowBox[{"a1", ",", " ", "a2", ",", " ", "a3"}], "]"}], ",", " ", 
     RowBox[{"SymbScalar", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"b1", ",", " ", "b2", ",", " ", "b3"}], "]"}]}], "]"}], ",", 
     " ", 
     RowBox[{"Symb", "[", 
      RowBox[{"c1", ",", " ", "c2"}], "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8900442766091385`*^9, 3.890044303182371*^9}, {
  3.890104320480432*^9, 3.8901043215918117`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"bf4ded3e-564c-4d61-a1d3-ac020137b131"],

Cell[BoxData[
 RowBox[{"SymbPlus", "[", 
  RowBox[{
   RowBox[{"Symb", "[", 
    RowBox[{"c1", ",", "c2"}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"Symb", "[", 
      RowBox[{"c2", ",", "c1"}], "]"}]}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a2", ",", "a3"}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"Symb", "[", 
      RowBox[{"a2", ",", "a1", ",", "a3"}], "]"}]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"Symb", "[", 
      RowBox[{"a2", ",", "a3", ",", "a1"}], "]"}]}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a3", ",", "a2", ",", "a1"}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"Symb", "[", 
      RowBox[{"b1", ",", "b2", ",", "b3"}], "]"}]}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"b2", ",", "b1", ",", "b3"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"b2", ",", "b3", ",", "b1"}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"Symb", "[", 
      RowBox[{"b3", ",", "b2", ",", "b1"}], "]"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.890044305074921*^9, 3.8900443221219683`*^9}, {
   3.890044360846119*^9, 3.890044367057954*^9}, {3.890104193526272*^9, 
   3.890104215179192*^9}, 3.8901043219571495`*^9, 3.8901049238084393`*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"4ea16fe1-ae84-4e73-b75d-60fc61879de1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Proj", "[", 
  RowBox[{"SymbPlus", "[", 
   RowBox[{
    RowBox[{"Symb", "[", 
     RowBox[{
      RowBox[{"1", "-", 
       RowBox[{"1", "/", "x"}]}], ",", " ", "x", ",", " ", 
      RowBox[{"5", "x"}]}], "]"}], ",", " ", 
    RowBox[{"SymbScalar", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{"1", "/", "x"}]}], ",", " ", "x", ",", " ", 
        RowBox[{"5", "x"}]}], "]"}]}], "]"}], ",", " ", 
    RowBox[{"Symb", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"3", "x"}], "+", "3"}], ",", " ", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"x", "-", "1"}], ")"}]}]}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8901040134576597`*^9, 3.890104077903243*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"b2ac62a3-6b67-4b4c-9f7f-b4453ef30ebd"],

Cell[BoxData[
 RowBox[{"SymbPlus", "[", 
  RowBox[{
   RowBox[{"Symb", "[", 
    RowBox[{
     RowBox[{"3", "+", 
      RowBox[{"3", " ", "x"}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}]}]}], "]"}], ",", 
   RowBox[{"SymbScalar", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"Symb", "[", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}]}], ",", 
       RowBox[{"3", "+", 
        RowBox[{"3", " ", "x"}]}]}], "]"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.8901040522191067`*^9, 3.8901040782743587`*^9}, 
   3.890104218685968*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"7f578d9f-42c9-4900-b0d5-ffecfda4a71e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymbolicExpressionToReadable", "[", "s3", "]"}]], "Input",
 CellChangeTimes->{{3.890104326137116*^9, 3.89010433341562*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"00bcf68d-9359-404d-a4b8-18fba649a697"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c1", "\[CircleTimes]", "c2"}], "-", 
  RowBox[{"c2", "\[CircleTimes]", "c1"}], "+", 
  RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], "-", 
  RowBox[{"a2", "\[CircleTimes]", "a1", "\[CircleTimes]", "a3"}], "-", 
  RowBox[{"a2", "\[CircleTimes]", "a3", "\[CircleTimes]", "a1"}], "+", 
  RowBox[{"a3", "\[CircleTimes]", "a2", "\[CircleTimes]", "a1"}], "-", 
  RowBox[{"b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3"}], "+", 
  RowBox[{"b2", "\[CircleTimes]", "b1", "\[CircleTimes]", "b3"}], "+", 
  RowBox[{"b2", "\[CircleTimes]", "b3", "\[CircleTimes]", "b1"}], "-", 
  RowBox[{"b3", "\[CircleTimes]", "b2", "\[CircleTimes]", "b1"}]}]], "Output",
 CellChangeTimes->{3.890104334066366*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"0f1ca151-dd1c-4571-b080-7e17c89f3503"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s4", " ", "=", " ", 
  RowBox[{"Shuffle", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Symb", "[", 
      RowBox[{"a1", ",", " ", "a2"}], "]"}], ",", " ", 
     RowBox[{"Symb", "[", "a3", "]"}], ",", " ", 
     RowBox[{"Symb", "[", "a4", "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8901043446645756`*^9, 3.890104356735224*^9}, {
   3.890104520930335*^9, 3.8901045813203793`*^9}, {3.8901046220229015`*^9, 
   3.890104627471142*^9}, {3.890104807321187*^9, 3.890104827488171*^9}, 
   3.8901049114703417`*^9, {3.8901049605809207`*^9, 3.890105031571906*^9}, {
   3.890105102784751*^9, 3.890105103575566*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"8471d1a3-6068-4d51-adde-2d47ab46b812"],

Cell[BoxData[
 RowBox[{"SymbPlus", "[", 
  RowBox[{
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a2", ",", "a4", ",", "a3"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a3", ",", "a2", ",", "a4"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a3", ",", "a4", ",", "a2"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a4", ",", "a2", ",", "a3"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a4", ",", "a3", ",", "a2"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a3", ",", "a1", ",", "a2", ",", "a4"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a3", ",", "a1", ",", "a4", ",", "a2"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a3", ",", "a4", ",", "a1", ",", "a2"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a4", ",", "a1", ",", "a2", ",", "a3"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a4", ",", "a1", ",", "a3", ",", "a2"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a4", ",", "a3", ",", "a1", ",", "a2"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.890104357501862*^9, {3.890104525264767*^9, 3.890104581839492*^9}, {
   3.8901046179890275`*^9, 3.890104627823287*^9}, {3.890104808929517*^9, 
   3.890104828259773*^9}, {3.8901049071127295`*^9, 3.8901049185377173`*^9}, 
   3.890104966695098*^9, 3.8901049991592655`*^9, 3.8901050329087296`*^9, 
   3.890105104022129*^9, 3.890130335980235*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"d3478f82-96f5-464b-8331-b8b1e0dcf746"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Proj", "[", "s4", "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"SymbPlus", "->", "Plus"}], ",", " ", 
     RowBox[{"SymbScalar", "->", "Times"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8901050413397655`*^9, 3.8901050878011484`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"a7bd1fff-7a5d-4454-88ff-868278562bdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a2", ",", "a4", ",", "a3"}], "]"}]}], "+", 
  RowBox[{"Symb", "[", 
   RowBox[{"a1", ",", "a4", ",", "a2", ",", "a3"}], "]"}], "+", 
  RowBox[{"Symb", "[", 
   RowBox[{"a1", ",", "a4", ",", "a3", ",", "a2"}], "]"}], "+", 
  RowBox[{"Symb", "[", 
   RowBox[{"a2", ",", "a1", ",", "a4", ",", "a3"}], "]"}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Symb", "[", 
    RowBox[{"a2", ",", "a4", ",", "a1", ",", "a3"}], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Symb", "[", 
    RowBox[{"a2", ",", "a4", ",", "a3", ",", "a1"}], "]"}]}], "+", 
  RowBox[{"Symb", "[", 
   RowBox[{"a3", ",", "a4", ",", "a1", ",", "a2"}], "]"}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Symb", "[", 
    RowBox[{"a3", ",", "a4", ",", "a2", ",", "a1"}], "]"}]}], "-", 
  RowBox[{"Symb", "[", 
   RowBox[{"a4", ",", "a1", ",", "a2", ",", "a3"}], "]"}], "-", 
  RowBox[{"Symb", "[", 
   RowBox[{"a4", ",", "a1", ",", "a3", ",", "a2"}], "]"}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"Symb", "[", 
    RowBox[{"a4", ",", "a2", ",", "a1", ",", "a3"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"Symb", "[", 
    RowBox[{"a4", ",", "a2", ",", "a3", ",", "a1"}], "]"}]}], "-", 
  RowBox[{"Symb", "[", 
   RowBox[{"a4", ",", "a3", ",", "a1", ",", "a2"}], "]"}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"Symb", "[", 
    RowBox[{"a4", ",", "a3", ",", "a2", ",", "a1"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.890105045028385*^9, 3.8901051071028376`*^9}},
 CellLabel->
  "Out[123]=",ExpressionUUID->"f524bc72-0a46-4243-b7e9-7a5a6a32b0e3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<ShuffleAlgebra.wl\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8901052460384955`*^9, 3.8901052641484575`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"6b0a8bb1-35c5-473b-8d50-68b01ce09e04"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WordShuffle", "[", 
    RowBox[{
     RowBox[{"word", "[", 
      RowBox[{"a", ",", " ", "b", ",", "x"}], "]"}], ",", " ", 
     RowBox[{"word", "[", 
      RowBox[{"c", ",", " ", "d", ",", " ", "y"}], "]"}], ",", " ", 
     RowBox[{"word", "[", 
      RowBox[{"e", ",", " ", "f", ",", " ", "z"}], "]"}], ",", " ", 
     RowBox[{"word", "[", "j", "]"}], ",", " ", 
     RowBox[{"word", "[", "k", "]"}]}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8901052670047846`*^9, 3.8901053284168377`*^9}, {
  3.890130368160256*^9, 3.890130386463703*^9}, {3.890130483317644*^9, 
  3.8901304873885465`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"36cd9642-1154-4207-9d3b-0552c60e9b88"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6450745`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.8901053290191936`*^9, 3.8901303884471674`*^9, 
  3.8901304887354717`*^9, 3.8901305341012535`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"ba0c1f98-a6a2-4f19-8930-74679b629a2c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Sh2", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a_", ",", " ", "b___"}], "]"}], ",", " ", 
     RowBox[{"S", "[", 
      RowBox[{"c_", ",", " ", "d___"}], "]"}]}], "]"}], ":=", 
   RowBox[{"SPlus", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a", ",", " ", 
       RowBox[{"Sh2", "[", 
        RowBox[{
         RowBox[{"S", "[", "b", "]"}], ",", " ", 
         RowBox[{"S", "[", 
          RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"c", ",", 
       RowBox[{"Sh2", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"a", ",", "b"}], "]"}], ",", 
         RowBox[{"S", "[", "d", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh2", "[", 
    RowBox[{
     RowBox[{"S", "[", "]"}], ",", "a_"}], "]"}], ":=", "a"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh2", "[", 
    RowBox[{"a_", ",", 
     RowBox[{"S", "[", "]"}]}], "]"}], ":=", "a"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh2", "[", "a_S", "]"}], ":=", "a"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh2", "[", 
    RowBox[{"a_", ",", "b_", ",", "c__"}], "]"}], ":=", 
   RowBox[{"Sh2", "[", 
    RowBox[{
     RowBox[{"Sh2", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules1", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"x___", ",", " ", "a_SPlus", ",", " ", "y___"}], "]"}], ":>", 
      RowBox[{"SPlus", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"x", ",", "#", ",", "y"}], "]"}], "&"}], " ", "/@", " ", 
         "a"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"SScalar", "[", 
          RowBox[{"b_", " ", ",", "a__S"}], "]"}], ",", "y___"}], "]"}], "/;", 
       RowBox[{"NumericQ", "[", "b", "]"}]}], ":>", 
      RowBox[{"SScalar", "[", 
       RowBox[{"b", ",", " ", 
        RowBox[{"S", "[", 
         RowBox[{"x", ",", "a", ",", "y"}], "]"}]}], "]"}]}], ",", "\n", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"___", ",", 
        RowBox[{"-", "1"}], ",", "___"}], "]"}], ":>", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"___", ",", "1", ",", "___"}], "]"}], ":>", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"___", ",", "0", ",", "___"}], "]"}], ":>", "0"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"rules2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"a___", ",", 
        RowBox[{"S", "[", "b__", "]"}], ",", " ", "c___"}], "]"}], ":>", 
      RowBox[{"S", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"SPlus", "[", "a_S", "]"}], ":>", "a"}], ",", " ", 
     RowBox[{
      RowBox[{"SPlus", "[", 
       RowBox[{"x___", ",", " ", "a__SPlus", ",", " ", "y___"}], "]"}], ":>", 
      RowBox[{"SPlus", "[", 
       RowBox[{"x", ",", " ", "a", ",", " ", "y"}], "]"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8901056303126106`*^9, 3.8901056404001594`*^9}, {
  3.890105883087966*^9, 3.8901058834346437`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"93b5b981-4861-4526-9068-a9ce92934b75"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res1", " ", "=", " ", 
  RowBox[{"Sh2", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"a1", ",", " ", "a2"}], "]"}], ",", " ", 
    RowBox[{"S", "[", "a3", "]"}], ",", " ", 
    RowBox[{"S", "[", "a4", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.890105644993129*^9, 3.89010566567152*^9}, {
  3.8901057241416435`*^9, 3.890105756052641*^9}, {3.8901058064907737`*^9, 
  3.890105814273785*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"84650141-11f6-47a0-9af1-c273385c59b8"],

Cell[BoxData[
 RowBox[{"Sh2", "[", 
  RowBox[{
   RowBox[{"SPlus", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a1", ",", 
       RowBox[{"SPlus", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"a2", ",", 
           RowBox[{"S", "[", "a3", "]"}]}], "]"}], ",", 
         RowBox[{"S", "[", 
          RowBox[{"a3", ",", 
           RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"a3", ",", 
       RowBox[{"S", "[", 
        RowBox[{"a1", ",", "a2"}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"S", "[", "a4", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8901056663285313`*^9, {3.890105740081236*^9, 3.890105757022613*^9}, {
   3.8901058074747405`*^9, 3.890105814712946*^9}, 3.890105889744438*^9},
 CellLabel->
  "Out[146]=",ExpressionUUID->"8b47d85c-046b-489e-8dd4-e7ea29cbadab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res12", " ", "=", " ", 
  RowBox[{"res1", "//.", 
   RowBox[{"{", 
    RowBox[{"SPlus", "->", "Plus"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8901059050417614`*^9, 3.8901059888614883`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"efea968a-9ce4-41ae-8cca-02c4e619b840"],

Cell[BoxData[
 RowBox[{"Sh2", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"a1", ",", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"a2", ",", 
         RowBox[{"S", "[", "a3", "]"}]}], "]"}], "+", 
       RowBox[{"S", "[", 
        RowBox[{"a3", ",", 
         RowBox[{"S", "[", "a2", "]"}]}], "]"}]}]}], "]"}], "+", 
    RowBox[{"S", "[", 
     RowBox[{"a3", ",", 
      RowBox[{"S", "[", 
       RowBox[{"a1", ",", "a2"}], "]"}]}], "]"}]}], ",", 
   RowBox[{"S", "[", "a4", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.890105946125434*^9, 3.8901059892470007`*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"a0388737-093a-4bc8-9182-297bcdcb3d4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res13", " ", "=", " ", 
  RowBox[{
   RowBox[{"res1", " ", "//.", " ", 
    RowBox[{"Union", "[", 
     RowBox[{"rules1", ",", " ", "rules2"}], "]"}]}], " ", "//.", " ", 
   RowBox[{"{", 
    RowBox[{"SPlus", "->", "Plus"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890106023941261*^9, 3.890106056803652*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"c6a825d4-e23d-4381-a3b8-8f8e3800ac42"],

Cell[BoxData[
 RowBox[{"Sh2", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"a1", ",", 
      RowBox[{"S", "[", 
       RowBox[{"a2", ",", 
        RowBox[{"S", "[", "a3", "]"}]}], "]"}]}], "]"}], "+", 
    RowBox[{"S", "[", 
     RowBox[{"a1", ",", 
      RowBox[{"S", "[", 
       RowBox[{"a3", ",", 
        RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], "]"}], "+", 
    RowBox[{"S", "[", 
     RowBox[{"a3", ",", "a1", ",", "a2"}], "]"}]}], ",", 
   RowBox[{"S", "[", "a4", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.8901060450924253`*^9, 3.890106057972992*^9}},
 CellLabel->
  "Out[150]=",ExpressionUUID->"6282ca0f-699d-495f-9968-82d1ee6eda94"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res2", " ", "=", " ", 
  RowBox[{"res1", " ", "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sh2", "[", 
        RowBox[{"a_SPlus", ",", " ", "y___"}], "]"}], ":>", 
       RowBox[{"Sh2", "[", 
        RowBox[{"#", ",", " ", "y"}], "]"}]}], "&"}], " ", "/@", " ", "a"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890105816867895*^9, 3.890105820331853*^9}, {
  3.890106451039358*^9, 
  3.8901064948526936`*^9}},ExpressionUUID->"b1ff34dc-9c8b-4c77-bf14-\
af0f2cfc88c0"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceRepeated", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"a\\\", \\\"}\\\"}]\\) is neither a list \
of replacement rules nor a valid dispatch table, and so cannot be used for \
replacing.\"", 2, 162, 3, 18830284985975430764, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.89010645365847*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"e3f6b960-5a58-4886-a156-efc08ab19b77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SPlus", "[", 
   RowBox[{
    RowBox[{"SPlus", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"a1", ",", 
        RowBox[{"SPlus", "[", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{
            RowBox[{"SPlus", "[", 
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"a2", ",", 
                RowBox[{"S", "[", "a3", "]"}]}], "]"}], ",", 
              RowBox[{"S", "[", 
               RowBox[{"a3", ",", 
                RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"S", "[", "a4", "]"}]}], "]"}], ",", 
          RowBox[{"S", "[", 
           RowBox[{"a4", ",", 
            RowBox[{"S", "[", 
             RowBox[{"SPlus", "[", 
              RowBox[{
               RowBox[{"S", "[", 
                RowBox[{"a2", ",", 
                 RowBox[{"S", "[", "a3", "]"}]}], "]"}], ",", 
               RowBox[{"S", "[", 
                RowBox[{"a3", ",", 
                 RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], "]"}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"a4", ",", 
        RowBox[{"S", "[", 
         RowBox[{"a1", ",", 
          RowBox[{"SPlus", "[", 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"a2", ",", 
              RowBox[{"S", "[", "a3", "]"}]}], "]"}], ",", 
            RowBox[{"S", "[", 
             RowBox[{"a3", ",", 
              RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"SPlus", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"a3", ",", 
        RowBox[{"SPlus", "[", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"a1", ",", "a2"}], "]"}], ",", 
            RowBox[{"S", "[", "a4", "]"}]}], "]"}], ",", 
          RowBox[{"S", "[", 
           RowBox[{"a4", ",", 
            RowBox[{"S", "[", 
             RowBox[{"S", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
       "]"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"a4", ",", 
        RowBox[{"S", "[", 
         RowBox[{"a3", ",", 
          RowBox[{"S", "[", 
           RowBox[{"a1", ",", "a2"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
   "]"}], "//.", "\[VeryThinSpace]", 
  RowBox[{"{", "a", "}"}]}]], "Output",
 CellChangeTimes->{3.890105821105237*^9, 3.890106453667471*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"5cb5f5e6-f425-437b-8715-c826d901f857"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res21", " ", "=", " ", 
  RowBox[{"res2", " ", "//.", 
   RowBox[{"{", 
    RowBox[{"SPlus", "->", "Plus"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890106104346797*^9, 3.890106124152946*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"a261af2a-0206-4bc2-b1b4-7212d213dc25"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"a1", ",", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a4", ",", 
       RowBox[{"S", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"a2", ",", 
           RowBox[{"S", "[", "a3", "]"}]}], "]"}], "+", 
         RowBox[{"S", "[", 
          RowBox[{"a3", ",", 
           RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], "]"}]}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"a2", ",", 
          RowBox[{"S", "[", "a3", "]"}]}], "]"}], "+", 
        RowBox[{"S", "[", 
         RowBox[{"a3", ",", 
          RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "a4", "]"}]}], "]"}]}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a3", ",", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a4", ",", 
       RowBox[{"S", "[", 
        RowBox[{"S", "[", 
         RowBox[{"a1", ",", "a2"}], "]"}], "]"}]}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"a1", ",", "a2"}], "]"}], ",", 
       RowBox[{"S", "[", "a4", "]"}]}], "]"}]}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a4", ",", 
    RowBox[{"S", "[", 
     RowBox[{"a1", ",", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"a2", ",", 
         RowBox[{"S", "[", "a3", "]"}]}], "]"}], "+", 
       RowBox[{"S", "[", 
        RowBox[{"a3", ",", 
         RowBox[{"S", "[", "a2", "]"}]}], "]"}]}]}], "]"}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a4", ",", 
    RowBox[{"S", "[", 
     RowBox[{"a3", ",", 
      RowBox[{"S", "[", 
       RowBox[{"a1", ",", "a2"}], "]"}]}], "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.8901061172979894`*^9, 3.8901061245171804`*^9}},
 CellLabel->
  "Out[152]=",ExpressionUUID->"2166374a-02ee-4fd6-9701-dcd33a886e2a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Sh3", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh3", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a_", ",", " ", "b___"}], "]"}], ",", " ", 
     RowBox[{"S", "[", 
      RowBox[{"c_", ",", " ", "d___"}], "]"}]}], "]"}], ":=", 
   RowBox[{"SPlus", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a", ",", " ", 
       RowBox[{"Sh3", "[", 
        RowBox[{
         RowBox[{"S", "[", "b", "]"}], ",", " ", 
         RowBox[{"S", "[", 
          RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"c", ",", 
       RowBox[{"Sh3", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"a", ",", "b"}], "]"}], ",", 
         RowBox[{"S", "[", "d", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh3", "[", 
    RowBox[{
     RowBox[{"S", "[", "]"}], ",", "a_"}], "]"}], ":=", "a"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh3", "[", 
    RowBox[{"a_", ",", 
     RowBox[{"S", "[", "]"}]}], "]"}], ":=", "a"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh3", "[", "a_S", "]"}], ":=", "a"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh3", "[", 
    RowBox[{"a_", ",", "b_", ",", "c__"}], "]"}], ":=", 
   RowBox[{"Sh3", "[", 
    RowBox[{
     RowBox[{"Sh3", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh3", "[", 
    RowBox[{"a_SPlus", ",", " ", "y___"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sh3", "[", 
      RowBox[{"#", ",", " ", "y"}], "]"}], "&"}], " ", "/@", " ", "a"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh3", "[", 
    RowBox[{"y___", ",", " ", "a_SPlus"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sh3", "[", 
      RowBox[{"y", ",", " ", "#"}], "]"}], "&"}], " ", "/@", " ", "a"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh3", "[", 
    RowBox[{"x___", ",", " ", 
     RowBox[{"SScalar", "[", 
      RowBox[{"a_", ",", " ", "b__"}], "]"}], ",", " ", "y___"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"SScalar", "[", 
     RowBox[{"a", ",", " ", 
      RowBox[{"Sh3", "[", 
       RowBox[{"x", ",", " ", "b", ",", " ", "y"}], "]"}]}], "]"}], " ", "/;",
     " ", 
    RowBox[{"NumericQ", "[", "a", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890106177072013*^9, 3.8901061910232368`*^9}, {
  3.8901065154609766`*^9, 3.890106534420376*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"d95bd1fd-6603-43c1-bd34-471504c23791"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res1", " ", "=", " ", 
  RowBox[{"Sh3", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"a1", ",", " ", "a2"}], "]"}], ",", " ", 
    RowBox[{"S", "[", "a3", "]"}], ",", " ", 
    RowBox[{"S", "[", "a4", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8901062097812824`*^9, 3.890106209949234*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"d64c630f-6697-4e70-8609-dff517e0ffa0"],

Cell[BoxData[
 RowBox[{"SPlus", "[", 
  RowBox[{
   RowBox[{"SPlus", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a1", ",", 
       RowBox[{"SPlus", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{
           RowBox[{"SPlus", "[", 
            RowBox[{
             RowBox[{"S", "[", 
              RowBox[{"a2", ",", 
               RowBox[{"S", "[", "a3", "]"}]}], "]"}], ",", 
             RowBox[{"S", "[", 
              RowBox[{"a3", ",", 
               RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], "]"}], ",", 
           RowBox[{"S", "[", "a4", "]"}]}], "]"}], ",", 
         RowBox[{"S", "[", 
          RowBox[{"a4", ",", 
           RowBox[{"S", "[", 
            RowBox[{"SPlus", "[", 
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"a2", ",", 
                RowBox[{"S", "[", "a3", "]"}]}], "]"}], ",", 
              RowBox[{"S", "[", 
               RowBox[{"a3", ",", 
                RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], "]"}], "]"}]}], 
          "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"a4", ",", 
       RowBox[{"S", "[", 
        RowBox[{"a1", ",", 
         RowBox[{"SPlus", "[", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"a2", ",", 
             RowBox[{"S", "[", "a3", "]"}]}], "]"}], ",", 
           RowBox[{"S", "[", 
            RowBox[{"a3", ",", 
             RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}], "]"}], ",", 
   RowBox[{"SPlus", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a3", ",", 
       RowBox[{"SPlus", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"a1", ",", "a2"}], "]"}], ",", 
           RowBox[{"S", "[", "a4", "]"}]}], "]"}], ",", 
         RowBox[{"S", "[", 
          RowBox[{"a4", ",", 
           RowBox[{"S", "[", 
            RowBox[{"S", "[", 
             RowBox[{"a1", ",", "a2"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"a4", ",", 
       RowBox[{"S", "[", 
        RowBox[{"a3", ",", 
         RowBox[{"S", "[", 
          RowBox[{"a1", ",", "a2"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.8901062104049478`*^9, {3.890106523798211*^9, 3.8901065373197093`*^9}},
 CellLabel->
  "Out[181]=",ExpressionUUID->"77633548-7447-4f3b-ad89-04eefd94c840"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Sh4", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh4", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a_", ",", " ", "b___"}], "]"}], ",", " ", 
     RowBox[{"S", "[", 
      RowBox[{"c_", ",", " ", "d___"}], "]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"a", ",", " ", 
      RowBox[{"Sh4", "[", 
       RowBox[{
        RowBox[{"S", "[", "b", "]"}], ",", " ", 
        RowBox[{"S", "[", 
         RowBox[{"c", ",", "d"}], "]"}]}], "]"}]}], "]"}], "+", 
    RowBox[{"S", "[", 
     RowBox[{"c", ",", 
      RowBox[{"Sh4", "[", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"a", ",", "b"}], "]"}], ",", 
        RowBox[{"S", "[", "d", "]"}]}], "]"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh4", "[", 
    RowBox[{
     RowBox[{"S", "[", "]"}], ",", "a_"}], "]"}], ":=", "a"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh4", "[", 
    RowBox[{"a_", ",", 
     RowBox[{"S", "[", "]"}]}], "]"}], ":=", "a"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh4", "[", "a_S", "]"}], ":=", "a"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh4", "[", 
    RowBox[{
     RowBox[{"S", "[", "f__", "]"}], ",", 
     RowBox[{"S", "[", "g__", "]"}], ",", "h__"}], "]"}], ":=", 
   RowBox[{"Sh4", "[", 
    RowBox[{
     RowBox[{"Sh4", "[", 
      RowBox[{
       RowBox[{"S", "[", "f", "]"}], ",", 
       RowBox[{"S", "[", "g", "]"}]}], "]"}], ",", "h"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh4", "[", 
    RowBox[{"x___", ",", "a_Plus", ",", " ", "y___"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sh4", "[", 
      RowBox[{"x", ",", "#", ",", " ", "y"}], "]"}], "&"}], " ", "/@", " ", 
    "a"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh4", "[", 
    RowBox[{"x___", ",", " ", 
     RowBox[{
      RowBox[{"Except", "[", 
       RowBox[{"_S", ",", " ", "a_"}], "]"}], "*", "b_"}], ",", " ", "y___"}],
     "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "*", " ", 
     RowBox[{"Sh4", "[", 
      RowBox[{"x", ",", " ", "b", ",", " ", "y"}], "]"}]}], " ", "/;", " ", 
    RowBox[{"NumericQ", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules3", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"x___", ",", "a_Plus", ",", "y___"}], "]"}], ":>", 
      RowBox[{"Plus", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"x", ",", " ", "#", ",", " ", "y"}], "]"}], "&"}], " ", "/@",
          " ", "a"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"b_", " ", "a_S"}], " ", ",", "y___"}], "]"}], "/;", 
       RowBox[{"NumericQ", "[", "b", "]"}]}], ":>", 
      RowBox[{"b", " ", 
       RowBox[{"S", "[", 
        RowBox[{"x", ",", "a", ",", "y"}], "]"}]}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.890106592626773*^9, 3.890106657249031*^9}, {
  3.890106719575774*^9, 3.890106759637465*^9}, {3.8901068404504433`*^9, 
  3.8901068444117618`*^9}, {3.8901073536119556`*^9, 3.8901073565794277`*^9}, {
  3.890107493126824*^9, 3.8901075275975695`*^9}, {3.8901075671163197`*^9, 
  3.890107580196026*^9}, {3.890109759785532*^9, 3.890109778552308*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"fc80508b-c631-4d70-a1d0-5913741aca89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res1", " ", "=", " ", 
  RowBox[{"Sh4", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"a1", ",", " ", "a2"}], "]"}], ",", " ", 
    RowBox[{"S", "[", "a3", "]"}], ",", " ", 
    RowBox[{"S", "[", "a4", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8901067667896805`*^9, 3.8901067839074373`*^9}, {
   3.8901069347988887`*^9, 3.8901070235879545`*^9}, 3.8901070592508335`*^9},
 CellLabel->
  "In[278]:=",ExpressionUUID->"5519728c-478f-4d65-b736-acb0e01ba702"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"a1", ",", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a4", ",", 
       RowBox[{"S", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"a2", ",", 
           RowBox[{"S", "[", "a3", "]"}]}], "]"}], "+", 
         RowBox[{"S", "[", 
          RowBox[{"a3", ",", 
           RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], "]"}]}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"a2", ",", 
          RowBox[{"S", "[", "a3", "]"}]}], "]"}], "+", 
        RowBox[{"S", "[", 
         RowBox[{"a3", ",", 
          RowBox[{"S", "[", "a2", "]"}]}], "]"}]}], ",", 
       RowBox[{"S", "[", "a4", "]"}]}], "]"}]}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a3", ",", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a4", ",", 
       RowBox[{"S", "[", 
        RowBox[{"S", "[", 
         RowBox[{"a1", ",", "a2"}], "]"}], "]"}]}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"a1", ",", "a2"}], "]"}], ",", 
       RowBox[{"S", "[", "a4", "]"}]}], "]"}]}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a4", ",", 
    RowBox[{"S", "[", 
     RowBox[{"a1", ",", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"a2", ",", 
         RowBox[{"S", "[", "a3", "]"}]}], "]"}], "+", 
       RowBox[{"S", "[", 
        RowBox[{"a3", ",", 
         RowBox[{"S", "[", "a2", "]"}]}], "]"}]}]}], "]"}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a4", ",", 
    RowBox[{"S", "[", 
     RowBox[{"a3", ",", 
      RowBox[{"S", "[", 
       RowBox[{"a1", ",", "a2"}], "]"}]}], "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.8901067845313993`*^9, 3.8901070244548807`*^9, 
  3.8901070603002205`*^9, 3.8901073609381676`*^9, 3.8901075876530204`*^9, 
  3.8901097821216817`*^9},
 CellLabel->
  "Out[278]=",ExpressionUUID->"6c33c4b4-e094-4813-b279-4e676ad48dc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res2", " ", "=", " ", 
  RowBox[{"res1", " ", "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"x___", ",", " ", 
       RowBox[{"S", "[", "b__", "]"}], ",", " ", "c___"}], "]"}], ":>", 
     RowBox[{"S", "[", 
      RowBox[{"x", ",", "b", ",", "c"}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8901070633311462`*^9, 3.8901070753703365`*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"aca62908-4721-4b06-9395-83d3b6069f8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"a1", ",", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a4", ",", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"a2", ",", "a3"}], "]"}], "+", 
        RowBox[{"S", "[", 
         RowBox[{"a3", ",", "a2"}], "]"}]}]}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"a2", ",", "a3"}], "]"}], "+", 
        RowBox[{"S", "[", 
         RowBox[{"a3", ",", "a2"}], "]"}]}], ",", "a4"}], "]"}]}]}], "]"}], 
  "+", 
  RowBox[{"S", "[", 
   RowBox[{"a3", ",", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a1", ",", "a2", ",", "a4"}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{"a4", ",", "a1", ",", "a2"}], "]"}]}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a4", ",", "a1", ",", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"a2", ",", "a3"}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{"a3", ",", "a2"}], "]"}]}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a4", ",", "a3", ",", "a1", ",", "a2"}], "]"}]}]], "Output",
 CellChangeTimes->{3.890107075577304*^9, 3.890107665606422*^9},
 CellLabel->
  "Out[268]=",ExpressionUUID->"6d8eba28-5d79-4d11-8318-c5fbcfefd7cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res3", " ", "=", " ", 
  RowBox[{"res2", " ", "//.", " ", "rules3"}]}]], "Input",
 CellChangeTimes->{{3.890106847634986*^9, 3.89010685404845*^9}, {
  3.8901071079285903`*^9, 3.8901071106726923`*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"c7fe2d6b-7b08-40e3-8007-5465fbec9a96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"a1", ",", 
    RowBox[{"S", "[", 
     RowBox[{"a4", ",", 
      RowBox[{"S", "[", 
       RowBox[{"a2", ",", "a3"}], "]"}]}], "]"}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a1", ",", 
    RowBox[{"S", "[", 
     RowBox[{"a4", ",", 
      RowBox[{"S", "[", 
       RowBox[{"a3", ",", "a2"}], "]"}]}], "]"}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a1", ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"a2", ",", "a3"}], "]"}], ",", "a4"}], "]"}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a1", ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"a3", ",", "a2"}], "]"}], ",", "a4"}], "]"}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a3", ",", 
    RowBox[{"S", "[", 
     RowBox[{"a1", ",", "a2", ",", "a4"}], "]"}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a3", ",", 
    RowBox[{"S", "[", 
     RowBox[{"a4", ",", "a1", ",", "a2"}], "]"}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a4", ",", "a1", ",", 
    RowBox[{"S", "[", 
     RowBox[{"a2", ",", "a3"}], "]"}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a4", ",", "a1", ",", 
    RowBox[{"S", "[", 
     RowBox[{"a3", ",", "a2"}], "]"}]}], "]"}], "+", 
  RowBox[{"S", "[", 
   RowBox[{"a4", ",", "a3", ",", "a1", ",", "a2"}], "]"}]}]], "Output",
 CellChangeTimes->{3.890106854792409*^9, 3.890107112302162*^9},
 CellLabel->
  "Out[216]=",ExpressionUUID->"accae0e2-3161-4577-88be-830d11c26ba2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s1", " ", "=", " ", 
  RowBox[{"Shuffle", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Symb", "[", 
      RowBox[{"a1", ",", " ", "a2"}], "]"}], ",", " ", 
     RowBox[{"Symb", "[", "a3", "]"}], ",", " ", 
     RowBox[{"Symb", "[", "a4", "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8901119641860285`*^9, 3.8901119762481556`*^9}, {
  3.8901122190731516`*^9, 3.890112219847691*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"e50b3327-bdb6-4816-a657-cca37bcf4119"],

Cell[BoxData[
 RowBox[{"SymbPlus", "[", 
  RowBox[{
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a2", ",", "a4", ",", "a3"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a3", ",", "a2", ",", "a4"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a3", ",", "a4", ",", "a2"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a4", ",", "a2", ",", "a3"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a1", ",", "a4", ",", "a3", ",", "a2"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a3", ",", "a1", ",", "a2", ",", "a4"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a3", ",", "a1", ",", "a4", ",", "a2"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a3", ",", "a4", ",", "a1", ",", "a2"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a4", ",", "a1", ",", "a2", ",", "a3"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a4", ",", "a1", ",", "a3", ",", "a2"}], "]"}], ",", 
   RowBox[{"Symb", "[", 
    RowBox[{"a4", ",", "a3", ",", "a1", ",", "a2"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.890111976738945*^9, {3.8901120880145392`*^9, 3.890112100308492*^9}, {
   3.8901122054324446`*^9, 3.89011222176886*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"777ad028-ec1a-4ff7-8280-538f1fc30b62"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Proj", "[", "s1", "]"}]], "Input",
 CellChangeTimes->{{3.890112225081929*^9, 3.890112228520347*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"50fcc13c-2635-4d11-ab95-96a0c42660ef"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.890112229000286*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"a1b4a9bb-39db-47e7-bafd-0baff05c088a"]
}, Open  ]]
},
WindowSize->{718.5, 735.75},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (August 22, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b4c134a4-81ae-47ab-8c32-19011cb41200"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5524, 168, 394, "Input",ExpressionUUID->"495c9de9-3f8a-40a9-bb7a-69b40be41516"],
Cell[CellGroupData[{
Cell[6107, 192, 1674, 44, 97, "Input",ExpressionUUID->"d76ef1d8-e31d-4c67-add3-182b3836b588"],
Cell[7784, 238, 3930, 115, 233, "Output",ExpressionUUID->"170f5bf3-ccc5-492f-b33a-082a75843d55"]
}, Open  ]],
Cell[11729, 356, 154, 3, 28, "Input",ExpressionUUID->"51d9087d-8335-474e-9d85-665bbf1b6f9b"],
Cell[CellGroupData[{
Cell[11908, 363, 1001, 29, 66, "Input",ExpressionUUID->"26705059-01f2-4dea-8018-be64daf1156f"],
Cell[12912, 394, 1150, 36, 85, "Output",ExpressionUUID->"bdd83ca5-5dd7-4b8a-b1fb-ef9faf8af990"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14099, 435, 1046, 30, 114, "Input",ExpressionUUID->"5baa08bc-debe-48a2-a678-8dfabf4e861a"],
Cell[15148, 467, 1016, 30, 85, "Output",ExpressionUUID->"23ad1d1d-41f8-460a-92de-d54d9136e60b"]
}, Open  ]],
Cell[16179, 500, 217, 3, 43, "Input",ExpressionUUID->"ec3bc6d0-91a3-4447-87a4-19d023dab68d"],
Cell[CellGroupData[{
Cell[16421, 507, 353, 7, 28, "Input",ExpressionUUID->"14ee395e-5273-41d7-b00f-499adffff654"],
Cell[16777, 516, 713, 15, 32, "Output",ExpressionUUID->"c0c3a201-6b9a-4643-b5ef-55291525f56c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17527, 536, 363, 7, 28, "Input",ExpressionUUID->"41ed0650-d732-4eb3-85a0-f229e9e09718"],
Cell[17893, 545, 625, 14, 32, "Output",ExpressionUUID->"7ed9144c-7147-42d3-9d09-32ce9231df2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18555, 564, 297, 6, 28, "Input",ExpressionUUID->"37eb9f49-b213-4f08-ae42-6a6098f66c2a"],
Cell[18855, 572, 1677, 45, 71, "Output",ExpressionUUID->"b2b38825-bed9-41f7-b930-bc572dbf858f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20569, 622, 229, 3, 28, "Input",ExpressionUUID->"ff6a98d5-9793-4489-9814-5e6c6d6af2ab"],
Cell[20801, 627, 1531, 49, 52, "Output",ExpressionUUID->"25ed3cd6-43d1-4ca5-b398-2e76d12fbc2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22369, 681, 807, 18, 62, "Input",ExpressionUUID->"3c267831-0c62-49cf-833a-28fe95913abf"],
Cell[23179, 701, 431, 8, 32, "Output",ExpressionUUID->"9970c952-9130-4f17-8461-46241c47cd73"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23647, 714, 857, 22, 28, "Input",ExpressionUUID->"b2e7e041-2e33-4df1-92df-2636527a63cc"],
Cell[24507, 738, 1739, 51, 122, "Output",ExpressionUUID->"aa2b990c-9985-429a-96da-c06e0dbeba10"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26283, 794, 214, 3, 28, "Input",ExpressionUUID->"42933979-d8d8-45c5-abe7-15d019a876f4"],
Cell[26500, 799, 2252, 65, 109, "Output",ExpressionUUID->"5167145d-2f17-479b-ac6f-856093eb7f01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28789, 869, 223, 3, 28, "Input",ExpressionUUID->"44187f68-ce01-441d-8f68-d20aad899cc0"],
Cell[29015, 874, 1292, 41, 52, "Output",ExpressionUUID->"870b917d-2830-4d0f-91c2-4c4f30d0cf3a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30344, 920, 404, 7, 28, "Input",ExpressionUUID->"eba61ab5-9cfc-41fd-a26d-1c1caa7e37d9"],
Cell[30751, 929, 385, 10, 32, "Output",ExpressionUUID->"1f2ca13d-be59-477c-94fd-7d420a431908"]
}, Open  ]],
Cell[31151, 942, 5634, 151, 358, "Input",ExpressionUUID->"7a1c222e-8c39-40cb-8991-09bef0765c6f"],
Cell[CellGroupData[{
Cell[36810, 1097, 1199, 25, 78, "Input",ExpressionUUID->"df59f55e-fba6-4870-a0fd-e4eb0716fdcc"],
Cell[38012, 1124, 1083, 20, 32, "Output",ExpressionUUID->"09cf049b-66ef-42b2-9d55-4ac72d97eea7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39132, 1149, 1174, 30, 62, "Input",ExpressionUUID->"27e652b9-7344-4591-9561-4d43b3628475"],
Cell[40309, 1181, 1160, 28, 52, "Output",ExpressionUUID->"e565cdf4-d8d4-4faa-b314-4840e28d4f46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41506, 1214, 707, 18, 28, "Input",ExpressionUUID->"bf4ded3e-564c-4d61-a1d3-ac020137b131"],
Cell[42216, 1234, 1582, 42, 90, "Output",ExpressionUUID->"4ea16fe1-ae84-4e73-b75d-60fc61879de1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43835, 1281, 882, 25, 48, "Input",ExpressionUUID->"b2ac62a3-6b67-4b4c-9f7f-b4453ef30ebd"],
Cell[44720, 1308, 790, 24, 32, "Output",ExpressionUUID->"7f578d9f-42c9-4900-b0d5-ffecfda4a71e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45547, 1337, 226, 3, 28, "Input",ExpressionUUID->"00bcf68d-9359-404d-a4b8-18fba649a697"],
Cell[45776, 1342, 823, 13, 52, "Output",ExpressionUUID->"0f1ca151-dd1c-4571-b080-7e17c89f3503"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46636, 1360, 723, 14, 28, "Input",ExpressionUUID->"8471d1a3-6068-4d51-adde-2d47ab46b812"],
Cell[47362, 1376, 1600, 33, 90, "Output",ExpressionUUID->"d3478f82-96f5-464b-8331-b8b1e0dcf746"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48999, 1414, 403, 10, 43, "Input",ExpressionUUID->"a7bd1fff-7a5d-4454-88ff-868278562bdd"],
Cell[49405, 1426, 1597, 39, 109, "Output",ExpressionUUID->"f524bc72-0a46-4243-b7e9-7a5a6a32b0e3"]
}, Open  ]],
Cell[51017, 1468, 228, 3, 43, "Input",ExpressionUUID->"6b0a8bb1-35c5-473b-8d50-68b01ce09e04"],
Cell[CellGroupData[{
Cell[51270, 1475, 753, 17, 62, "Input",ExpressionUUID->"36cd9642-1154-4207-9d3b-0552c60e9b88"],
Cell[52026, 1494, 283, 5, 32, "Output",ExpressionUUID->"ba0c1f98-a6a2-4f19-8930-74679b629a2c"]
}, Open  ]],
Cell[52324, 1502, 3441, 105, 235, "Input",ExpressionUUID->"93b5b981-4861-4526-9068-a9ce92934b75"],
Cell[CellGroupData[{
Cell[55790, 1611, 511, 12, 28, "Input",ExpressionUUID->"84650141-11f6-47a0-9af1-c273385c59b8"],
Cell[56304, 1625, 876, 24, 32, "Output",ExpressionUUID->"8b47d85c-046b-489e-8dd4-e7ea29cbadab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57217, 1654, 301, 7, 43, "Input",ExpressionUUID->"efea968a-9ce4-41ae-8cca-02c4e619b840"],
Cell[57521, 1663, 684, 20, 32, "Output",ExpressionUUID->"a0388737-093a-4bc8-9182-297bcdcb3d4b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58242, 1688, 418, 10, 43, "Input",ExpressionUUID->"c6a825d4-e23d-4381-a3b8-8f8e3800ac42"],
Cell[58663, 1700, 670, 19, 32, "Output",ExpressionUUID->"6282ca0f-699d-495f-9968-82d1ee6eda94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59370, 1724, 533, 15, 28, "Input",ExpressionUUID->"b1ff34dc-9c8b-4c77-bf14-af0f2cfc88c0"],
Cell[59906, 1741, 461, 10, 28, "Message",ExpressionUUID->"e3f6b960-5a58-4886-a156-efc08ab19b77"],
Cell[60370, 1753, 2548, 73, 109, "Output",ExpressionUUID->"5cb5f5e6-f425-437b-8715-c826d901f857"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62955, 1831, 302, 7, 43, "Input",ExpressionUUID->"a261af2a-0206-4bc2-b1b4-7212d213dc25"],
Cell[63260, 1840, 1855, 57, 71, "Output",ExpressionUUID->"2166374a-02ee-4fd6-9701-dcd33a886e2a"]
}, Open  ]],
Cell[65130, 1900, 2581, 83, 231, "Input",ExpressionUUID->"d95bd1fd-6603-43c1-bd34-471504c23791"],
Cell[CellGroupData[{
Cell[67736, 1987, 412, 10, 28, "Input",ExpressionUUID->"d64c630f-6697-4e70-8609-dff517e0ffa0"],
Cell[68151, 1999, 2444, 72, 90, "Output",ExpressionUUID->"77633548-7447-4f3b-ad89-04eefd94c840"]
}, Open  ]],
Cell[70610, 2074, 3452, 104, 298, "Input",ExpressionUUID->"fc80508b-c631-4d70-a1d0-5913741aca89"],
Cell[CellGroupData[{
Cell[74087, 2182, 492, 11, 28, "Input",ExpressionUUID->"5519728c-478f-4d65-b736-acb0e01ba702"],
Cell[74582, 2195, 1955, 59, 71, "Output",ExpressionUUID->"6c33c4b4-e094-4813-b279-4e676ad48dc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76574, 2259, 485, 12, 28, "Input",ExpressionUUID->"aca62908-4721-4b06-9395-83d3b6069f8f"],
Cell[77062, 2273, 1241, 38, 52, "Output",ExpressionUUID->"6d8eba28-5d79-4d11-8318-c5fbcfefd7cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78340, 2316, 306, 6, 28, "Input",ExpressionUUID->"c7fe2d6b-7b08-40e3-8007-5465fbec9a96"],
Cell[78649, 2324, 1519, 46, 71, "Output",ExpressionUUID->"accae0e2-3161-4577-88be-830d11c26ba2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80205, 2375, 500, 11, 28, "Input",ExpressionUUID->"e50b3327-bdb6-4816-a657-cca37bcf4119"],
Cell[80708, 2388, 1379, 30, 90, "Output",ExpressionUUID->"777ad028-ec1a-4ff7-8280-538f1fc30b62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82124, 2423, 202, 3, 28, "Input",ExpressionUUID->"50fcc13c-2635-4d11-ab95-96a0c42660ef"],
Cell[82329, 2428, 148, 2, 32, "Output",ExpressionUUID->"a1b4a9bb-39db-47e7-bafd-0baff05c088a"]
}, Open  ]]
}
]
*)

